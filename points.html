<!DOCTYPE html>
<html lang="en">

<!-- Basic -->
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<!-- Mobile Metas -->
<meta name="viewport" content="width=device-width, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">

<!-- Site Metas -->
<title>Greatseo - Bootstrap 4 Responsive HTML5 Template</title>
<meta name="keywords" content="">
<meta name="description" content="">
<meta name="author" content="">

<!-- Site Icons -->
<link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon" />
<link rel="apple-touch-icon" href="images/apple-touch-icon.png">

<!-- Bootstrap CSS -->
<link rel="stylesheet" href="css/bootstrap.min.css">
<!-- Site CSS -->
<link rel="stylesheet" href="style.css">
<!-- ALL VERSION CSS -->
<link rel="stylesheet" href="css/versions.css">
<!-- Responsive CSS -->
<link rel="stylesheet" href="css/responsive.css">
<!-- Custom CSS -->
<link rel="stylesheet" href="css/custom.css">

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-150425825-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-150425825-1');
  gtag('set', {'user_id': 'USER_ID'}); // Set the user ID using signed-in user_id.
  ga('set', 'userId', 'USER_ID'); // Set the user ID using signed-in user_id.
</script>

<!-- Material Design Theming -->
<link rel="stylesheet" href="https://code.getmdl.io/1.1.3/material.orange-indigo.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
<script defer src="https://code.getmdl.io/1.1.3/material.min.js"></script>

<link rel="stylesheet" href="main.css">
<!-- <script src="signin.js"></script> -->


<!-- Import and configure the Firebase SDK -->
<!-- These scripts are made available when the app is served or deployed on Firebase Hosting -->
<!-- If you do not serve/host your project using Firebase Hosting see https://firebase.google.com/docs/web/setup -->
<!-- <script>
    import * as firebase from 'firebase';
    </script> -->
<script src="/__/firebase/7.5.0/firebase-app.js"></script>


<script src="/__/firebase/7.5.0/firebase-analytics.js"></script>


<script src="/__/firebase/7.5.0/firebase-auth.js"></script>
<script src="/__/firebase/7.5.0/firebase-firestore.js"></script>
<script src="/__/firebase/7.5.0/firebase-database.js"></script>


</head>
<body class="seo_version">

  <!-- LOADER -->
  <div id="preloader">
    <div class="loader-wrapper">
      <div class="loader-new">
        <div class="ball"></div>
        <div class="ball"></div>
        <div class="ball"></div>
      </div>
      <div class="text">LOADING...</div>
    </div>
  </div>
  <!-- END LOADER -->

  <!-- Start header -->
  <header class="top-navbar">
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <div class="container">
        <!-- <a class="navbar-brand" href="index.html">
          <img src="http://www.fbla-pbl.org/media/FBLA-Logo-Color.png" width="150" height="40" alt="" />
        </a> -->
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbars-seo" aria-controls="navbars-rs-food" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbars-seo">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
            <li class="nav-item active"><a class="nav-link" href="calendar.html">About Us</a></li>
            <li class="nav-item"><a class="nav-link" href="about.html">Newsletters</a></li>

            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="dropdown-a" data-toggle="dropdown">Gallery </a>
              <div class="dropdown-menu" aria-labelledby="dropdown-a">
                <a class="dropdown-item" href="gallery.html">Meetings</a>
                <a class="dropdown-item" href="gallery.html">Events</a>
                <a class="dropdown-item" href="gallery.html">Other</a>

              </div>
            </li>
            <li class="nav-item"><a class="nav-link" href="pricing.html">Resources</a></li>
            <li class="nav-item"><a class="nav-link" href="contact.html">Contact</a></li>
            <li class="nav-item"><a class="nav-link" href="points.html">Points</a></li>
          </ul>
        </div>
      </div>
    </nav>
  </header>
  <!-- End header -->

  <div class="all-page-title" style="background-image:url(images/pattern-4.png);">
    <!--Page -->
    <div class="page-info">
      <div class="container">
        <div class="inner-container">
          <ul class="bread-crumb">
          </ul>
        </div>
      </div>
    </div>
    <!--End Page-->
    <div class="container text-center">
      <h2><Points</h2>
  <b>  <font size="6" color="white" <h2> Sign-in to view your points! </h2> </font> </b>
<!-- <p><a href="signin.html">Click</a> -->
    </div>
  </div><!-- end section -->
  <p id="demo"></p>
  <p id="test"></p>












<body>
<div class="demo-layout mdl-layout mdl-js-layout mdl-layout--fixed-header">

  <!-- Header section containing title -->
  <header class="mdl-layout__header mdl-color-text--white mdl-color--light-blue-700">
    <div class="mdl-cell mdl-cell--12-col mdl-cell--12-col-tablet mdl-grid">
      <div class="mdl-layout__header-row mdl-cell mdl-cell--12-col mdl-cell--12-col-tablet mdl-cell--8-col-desktop">
        <!-- <a href="/"><h3>Firebase Authentication</h3></a> -->
      </div>
    </div>
  </header>

  <main class="mdl-layout__content mdl-color--blue-100">
    <div class="mdl-cell mdl-cell--12-col mdl-cell--12-col-tablet mdl-grid">

      <!-- Container for the demo -->
      <div class="mdl-card mdl-shadow--2dp mdl-cell mdl-cell--12-col mdl-cell--12-col-tablet mdl-cell--12-col-desktop">
        <div class="mdl-card__title mdl-color--light-blue-600 mdl-color-text--white">
          <!-- <h2 class="mdl-card__title-text">Google Authentication with Popup</h2> -->
        </div>
        <div class="mdl-card__supporting-text mdl-color-text--grey-600">
          <p style="font-family:verdana;"> <center><font size="3" color="black" <p>Sign in with your school Google account below.</p></font></center>
          <br> </br>

          <!-- Button that handles sign-in/sign-out -->
          <center><button disabled class="mdl-button mdl-js-button mdl-button--raised" id="quickstart-sign-in">Sign in with Google</button></center>

          <br> </br>
          <h2 style="font-family:verdana;"> <center> <font size="6" color="black" id= "yourpoints" <h2> Your Points: </h2> </font-family> </font> </center>




            <center><div id="mypoints"></div><center>
              <style>
              #mypoints{
                font-family: verdana;
                color: black;
                font-size: 20px;

              }
              #yourpoints{
                display:block;
              }
              </style>

          <div class="container my-5">
            <br>
          </br>
            <div id="myDIV">
            Error. Please input your school email below.
            </div>
            <br>
          </br>
          <style>
          #myDIV{
            font-family: verdana;
            color: black;
            font-size: 20px;
          }
          </style>
            <div class="row">
              <div class="col-md-6 mx-auto">
                <div class="form-group">
                  <input type="text" id="name" class="form-control" id="input" required>
                  <br> </br>

                  <input type="button" id="submit" value="Submit" onclick="getvalue();"required>

                  <br> </br>
                  <label class="form-control-placeholder" for="name"</label>
                    <br>
                  </br>

                  <p id= "input"></p>

                </div>

          <style>
            .form-group {
            position: relative;
            margin-bottom: 1.5rem;
            /* visibility: hidden; */
          }

          .form-control-placeholder {
            position: absolute;
            top: 0;
            padding: 7px 0 0 13px;
            transition: all 200ms;
            opacity: 0.5;
          }


          .form-control:focus + .form-control-placeholder,
          .form-control:valid + .form-control-placeholder {
            font-size: 75%;
            transform: translate3d(0, -100%, 0);
            opacity: 1;
          }
          </style>
          <center><div id="message">
          If you have any questions about your points, please visit the contact page.
          </div></center>
          <style>
          #message{
            font-family: verdana;
            color: black;
            font-size: 10px;
          }
          </style>
          <script>

          document.getElementById("name").style.display="none";
          document.getElementById("submit").style.display="none";
          document.getElementById("myDIV").style.display= "none";
          document.getElementById("yourpoints").style.display="block";
          //document.getElementById("mypoints").style.display="none";

          </script>
          <!-- Container where we'll display the user details -->
          <div class="quickstart-user-details-container">
           <span id="quickstart-sign-in-status"></span>
            <div> <code></code></div>
            <pre><code id="quickstart-account-details"></code></pre>
            <div></div>
            <!-- <pre><code id="quickstart-oauthtoken"></code></pre> -->
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
</body>


<!-- <script src="https://www.gstatic.com/firebasejs/7.5.0/firebase-firestore.js"></script> -->







<script type="text/javascript">



  /**
   * Function called when clicking the Login/Logout button.
   */
  // [START buttoncallback]

  function toggleSignIn() {


    if (!firebase.auth().currentUser) {
      // [START createprovider]
      var config = {
        apiKey: "AIzaSyBqPq5zvMTXv72ngFLPQe8RHE1DxBFWs9w",
        authDomain: "my-project-1574031936136.firebaseapp.com",
        databaseURL: "https://my-project-1574031936136.firebaseio.com",
        projectId: "my-project-1574031936136",
        storageBucket: "my-project-1574031936136.appspot.com",
        messagingSenderId: "1053075746804",

      };
      if (!firebase.apps.length) {
        firebase.initializeApp(config);
}
      var provider = new firebase.auth.GoogleAuthProvider();
      // [END createprovider]
      // [START addscopes]
      // provider.addScope('https://www.googleapis.com/auth/contacts.readonly');
      // [END addscopes]
      // [START signin]
      firebase.auth().signInWithPopup(provider).then(function(result) {
        // This gives you a Google Access Token. You can use it to access the Google API.
        var token = result.credential.accessToken;
        // The signed-in user info.
        var user = result.user;
        // [START_EXCLUDE]
        document.getElementById('quickstart-oauthtoken').textContent = token;
        // [END_EXCLUDE]
      }).catch(function(error) {
        // Handle Errors here.
        var errorCode = error.code;
        var errorMessage = error.message;
        // The email of the user's account used.
        var email = error.email;
        // The firebase.auth.AuthCredential type that was used.
        var credential = error.credential;
        // [START_EXCLUDE]
        if (errorCode === 'auth/account-exists-with-different-credential') {
          alert('You have already signed up with a different auth provider for that email.');
          // If you are using multiple auth providers on your app you should handle linking
          // the user's accounts here.
        } else {
          console.error(error);
        }
        // [END_EXCLUDE]
      });
      // [END signin]

    } else {
      // [START signout]

      document.getElementById("yourpoints").style.display="none";
      document.getElementById("mypoints").style.visibility="hidden";
      firebase.auth().signOut();
      window.location.reload();
      //document.getElementById("mypoints").style.display="none";



      // [END signout]
    }
    // [START_EXCLUDE]
    document.getElementById('quickstart-sign-in').disabled = true;

    //document.getElementById("mypoints").style.display="none";


    // [END_EXCLUDE]
  }
  // [END buttoncallback]
  /**
   * initApp handles setting up UI event listeners and registering Firebase auth listeners:
   *  - firebase.auth().onAuthStateChanged: This listener is called when the user is signed in or
   *    out, and that is where we update the UI.

   */

  function initApp() {
    // Listening for auth state changes.
    // [START authstatelistener]
    var config = {
      apiKey: "AIzaSyBqPq5zvMTXv72ngFLPQe8RHE1DxBFWs9w",
      authDomain: "my-project-1574031936136.firebaseapp.com",
      databaseURL: "https://my-project-1574031936136.firebaseio.com",
      projectId: "my-project-1574031936136",
      storageBucket: "my-project-1574031936136.appspot.com",
      messagingSenderId: "1053075746804",

    };
    // console.log(config);
    firebase.initializeApp(config);
    var pointval=0;



    // const config= {
    //   apiKey: "AIzaSyBqPq5zvMTXv72ngFLPQe8RHE1DxBFWs9w",
    //   authDomain: "my-project-1574031936136.firebaseapp.com",
    //   databaseURL: "https://my-project-1574031936136.firebaseio.com/",
    //   storageBucket: "my-project-1574031936136.appspot.com",
    //
    // };
    // firebase.initializeApp(config1);
//     if (!firebase.apps.length) {
//       firebase.initializeApp(config);
// }
    // const firebaseApp=firebase;




    firebase.auth().onAuthStateChanged(function(user) {


       if (user) {
        // User is signed in.
        var displayName = user.displayName;
        var email = user.email;
        if (email.includes("gmail")==true){
          // alert("Error!")

              firebase.auth().signOut();
              document.getElementById("name").style.display = "block";
              document.getElementById("submit").style.display= "block";
              document.getElementById("myDIV").style.display= "block";
              document.getElementById("mypoints").style.display="none";
              document.getElementById("yourpoints").style.display="none";

              //document.getElementById("message").style.display="block";
              document.getElementById("submit").addEventListener("click", getvalue, false);

              function getvalue(){
                document.getElementById("name").style.display = "none";
                document.getElementById("submit").style.display= "none";
                document.getElementById("myDIV").style.display= "none";
                document.getElementById("yourpoints").style.display="block";
              var userinput= document.getElementById("name").value;
              var userinput1=userinput.substring(0,7);
              console.log(userinput1);


              //document.getElementById("input").innerHTML=userinput;
              var ref = firebase.database().ref();

              ref.on("value", function(snapshot) {
                 var obj= snapshot.val();
            //     console.log(obj);

                 var stringified= JSON.stringify(obj);
              //   alert("stringified value is:" stringified);
              //   alert(stringified);

                 var parsedObj = JSON.parse(stringified);
                // alert(parsedObj);
                 // console.log(parsedObj);



                 // var result = [];
                 //
                 //  for(var i in stringified)
                 //   result.push([i, stringified [i]]);

                 var keyval = Object.keys(parsedObj);
                 console.log(keyval);
                 var values = Object.values(parsedObj);
                 console.log(values);

                // var keys = []
                  //for(var k in stringified){
                  //         keys.push(k)
                  //   }
                  // console.log(keyval[0]);
                     var arrayLength = keyval.length;
                     var foundindex;
                     // for (var i = 0; i < arrayLength; i++) {
                      //    console.log(i);
                      var i=0;
                      while (i<arrayLength){
                       if (keyval[i] == userinput1) {
                          console.log(keyval[i]);
                          console.log(i);
                          foundindex = i;



                       }
                       i++;
                     }
                     //console.log(foundindex);
                     // if(foundindex==email){
                     //   document.getElementById("test").innerHTML = values[foundindex];
                     // }

                      pointval=values[foundindex];
                     //console.log(pointval);
                     //document.getElementById("yourpoints").style.display="block";
                     document.getElementById("mypoints").innerHTML=pointval;
                     document.getElementById("mypoints").style.display="block";

                    // document.getElementById("message").style.display="block";





              }, function (error) {
                 console.log("Error: " + error.code);
              });



              //document.getElementById('quickstart-sign-in').textContent = 'Sign in with Google';

              // document.getElementById('quickstart-sign-in').addEventListener('click', hidepoints, false);




            }



              // var button = document.createElement("button");
              // button.innerHTML = "Submit";
              //
              // // 2. Append somewhere
              // var body = document.getElementsByTagName("body")[0];
              // body.appendChild(button);
              //
              // // 3. Add event handler
              // button.addEventListener ("click", function() {
              //   alert("did something");
              // });


           // document.getElementById('quickstart-sign-out').trigger('click');
           // document.getElementById('quickstart-sign-in').addEventListener('click', toggleSignIn, false);
           // document.getElementById('quickstart-sign-in').disabled = true;



        }
        var emailVerified = user.emailVerified;
        var photoURL = user.photoURL;
        var isAnonymous = user.isAnonymous;
        var uid = user.uid;
        var providerData = user.providerData;
        var email=user.email;
        var emailuser=email.substring(0,7);

        console.log(emailuser);


        // [START_EXCLUDE]
        document.getElementById('quickstart-sign-in-status').textContent = 'Signed in';
        document.getElementById('quickstart-sign-in').textContent = 'Sign out';
        document.getElementById('quickstart-account-details').textContent =null;
        //document.getElementById('mypoints').style.display="none";
        // [END_EXCLUDE]
      } else {
        // User is signed out.
        // [START_EXCLUDE]

        document.getElementById('quickstart-sign-in-status').textContent = 'Signed out';


        document.getElementById('quickstart-sign-in').textContent = 'Sign in with Google';
          document.getElementById('quickstart-account-details').textContent =null;
        document.getElementById("mypoints").style.display="none";
        // document.getElementById('quickstart-account-details').textContent = 'null';
        // document.getElementById('quickstart-oauthtoken').textContent = 'null';
        // [END_EXCLUDE]
      }
      // [START_EXCLUDE]
      document.getElementById('quickstart-sign-in').disabled = false;


      // [END_EXCLUDE]

      var ref = firebase.database().ref();


      ref.on("value", function(snapshot) {
         var obj= snapshot.val();
    //     console.log(obj);

         var stringified= JSON.stringify(obj);
      //   alert("stringified value is:" stringified);
      //   alert(stringified);

         var parsedObj = JSON.parse(stringified);
        // alert(parsedObj);
         // console.log(parsedObj);



         // var result = [];
         //
         //  for(var i in stringified)
         //   result.push([i, stringified [i]]);

         var keyval = Object.keys(parsedObj);
         console.log(keyval);
         var values = Object.values(parsedObj);
         console.log(values);

        // var keys = []
          //for(var k in stringified){
          //         keys.push(k)
          //   }
          // console.log(keyval[0]);
             var arrayLength = keyval.length;
            //var foundindex=1;
             // for (var i = 0; i < arrayLength; i++) {
              //    console.log(i);
              var i=0;
              while (i<arrayLength){
               if (keyval[i] == emailuser) {
                  console.log(keyval[i]);
                  console.log(i);
                  foundindex = i;
                  console.log(foundindex);



               }
               i++;
             }
             //console.log(foundindex);
             // if(foundindex==email){
             //   document.getElementById("test").innerHTML = values[foundindex];
             // }
        //    var pointval=0;
             pointval=values[foundindex];
            // console.log(pointval);
            //document.getElementById("mypoints").childNodes[0].nodeValue=null;
            document.getElementById("mypoints").style.display="none";

             document.getElementById("mypoints").innerHTML=pointval;



             document.getElementById("mypoints").style.display="block";




      }, function (error) {
         console.log("Error: " + error.code);
      });
    });
    // [END authstatelistener]

    document.getElementById('quickstart-sign-in').addEventListener('click', toggleSignIn, false);
      //document.getElementById("mypoints").style.display="none";

  }

  window.onload = function() {

  initApp();
  };
</script>









  <!-- <div class="copyrights">
    <div class="container">
      <div class="footer-distributed">
        <div class="footer-left">
      <p class="footer-company-name">All Rights Reserved. &copy; 2019 <a href="#">JPS-Astronomy</a> Design By : Smruthi S <a href=""></a></p>
        </div>
      </div>
    </div><!-- end container -->
  </div><!-- end copyrights -->

  <!-- <a href="#" id="scroll-to-top" class="dmtop global-radius"><i class="fa fa-angle-up"></i></a> --> -->

  <!-- ALL JS FILES -->
  <script src="js/all.js"></script>
  <!-- ALL PLUGINS -->
  <script src="js/custom.js"></script>
  <script src="js/portfolio.js"></script>
  <script src="js/hoverdir.js"></script>
  <script src="js/tippy.all.min.js"></script>
  <script>
  tippy('.btn-a')
</script>

</body>
</html>
